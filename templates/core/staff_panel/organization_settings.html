{% extends 'core/staff_panel/base.html' %}

{% block staff_panel_content %}
<div class="p-8">
    <!-- Header -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900">Organization Settings</h2>
        <p class="text-gray-600 mt-2">Manage your organization's profile, preferences, and configuration.</p>
    </div>

    {% if messages %}
        {% for message in messages %}
            <div class="mb-6 p-4 rounded-lg {% if message.tags == 'error' %}bg-red-50 border border-red-200 text-red-800{% elif message.tags == 'success' %}bg-green-50 border border-green-200 text-green-800{% else %}bg-blue-50 border border-blue-200 text-blue-800{% endif %}">
                <div class="flex items-center">
                    {% if message.tags == 'error' %}
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    {% elif message.tags == 'success' %}
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    {% endif %}
                    {{ message }}
                </div>
            </div>
        {% endfor %}
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="space-y-8">
        {% csrf_token %}
        
        <!-- Basic Information -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-6">Basic Information</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="{{ form.name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Organization Name
                    </label>
                    {{ form.name }}
                    {% if form.name.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.name.errors.0 }}</p>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.website.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Website
                    </label>
                    {{ form.website }}
                    {% if form.website.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.website.errors.0 }}</p>
                    {% endif %}
                </div>
                
                <div class="md:col-span-2">
                    <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Description
                    </label>
                    {{ form.description }}
                    {% if form.description.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.description.errors.0 }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Contact Information -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-6">Contact Information</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="{{ form.contact_email.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Contact Email
                    </label>
                    {{ form.contact_email }}
                    {% if form.contact_email.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.contact_email.errors.0 }}</p>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.phone.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Phone Number
                    </label>
                    {{ form.phone }}
                    {% if form.phone.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.phone.errors.0 }}</p>
                    {% endif %}
                </div>
                
                <div class="md:col-span-2">
                    <label for="{{ form.address.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Address
                    </label>
                    {{ form.address }}
                    {% if form.address.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.address.errors.0 }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Preferences -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-6">Preferences</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="{{ form.timezone.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Timezone
                    </label>
                    {{ form.timezone }}
                    {% if form.timezone.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.timezone.errors.0 }}</p>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.date_format.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Date Format
                    </label>
                    {{ form.date_format }}
                    {% if form.date_format.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.date_format.errors.0 }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Logo Upload -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-6">Organization Logo</h3>
            <div class="flex items-start space-x-6">
                {% if organization.logo %}
                    <div class="flex-shrink-0">
                        <img src="{{ organization.logo.url }}" alt="{{ organization.name }} logo" 
                             class="w-20 h-20 rounded-lg object-cover border border-gray-200">
                    </div>
                {% else %}
                    <div class="flex-shrink-0 w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center border border-gray-200">
                        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                {% endif %}
                <div class="flex-1">
                    <label for="{{ form.logo.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Upload New Logo
                    </label>
                    {{ form.logo }}
                    {% if form.logo.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.logo.errors.0 }}</p>
                    {% endif %}
                    <p class="mt-2 text-sm text-gray-600">
                        Recommended: PNG or JPG, maximum 2MB, square aspect ratio for best results.
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Security Settings -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-6">Security Settings</h3>
            <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div>
                        <h4 class="font-medium text-gray-900">Two-Factor Authentication</h4>
                        <p class="text-sm text-gray-600">Require 2FA for all organization members</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" name="require_2fa" class="sr-only peer" 
                               {% if organization.settings.require_2fa %}checked{% endif %}>
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                    </label>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div>
                        <h4 class="font-medium text-gray-900">Session Timeout</h4>
                        <p class="text-sm text-gray-600">Automatically log out idle users after 8 hours</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" name="session_timeout" class="sr-only peer"
                               {% if organization.settings.session_timeout %}checked{% endif %}>
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                    </label>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div>
                        <h4 class="font-medium text-gray-900">IP Restrictions</h4>
                        <p class="text-sm text-gray-600">Limit access to specific IP addresses</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" name="ip_restrictions" class="sr-only peer"
                               {% if organization.settings.ip_restrictions %}checked{% endif %}>
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="flex justify-end space-x-4">
            <a href="{% url 'core:staff_dashboard' %}" 
               class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                Cancel
            </a>
            <button type="submit" 
                    class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                Save Changes
            </button>
        </div>
    </form>
</div>

<style>
/* Form field styling */
input[type="text"], input[type="email"], input[type="url"], input[type="tel"], 
textarea, select {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    font-size: 0.875rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

input[type="text"]:focus, input[type="email"]:focus, input[type="url"]:focus, 
input[type="tel"]:focus, textarea:focus, select:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

textarea {
    resize: vertical;
    min-height: 100px;
}

input[type="file"] {
    width: 100%;
    padding: 0.5rem;
    border: 2px dashed #d1d5db;
    border-radius: 0.5rem;
    background-color: #f9fafb;
    cursor: pointer;
    transition: border-color 0.15s ease-in-out;
}

input[type="file"]:hover {
    border-color: #9ca3af;
}
</style>
{% endblock %}
